{
	"info": {
		"_postman_id": "7d5b3baf-b3fa-47b7-b474-9e31c02e9bba",
		"name": "Team7_Dietician_Phase1APIHackathon_2024 Copy",
		"schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
		"_exporter_id": "37338910",
		"_collection_link": "https://postman-geeks-6315.postman.co/workspace/Team7_Dietician_Phase1APIHackat~68a54a3c-24f0-468f-a13f-3a4f28686c5b/collection/37338910-7d5b3baf-b3fa-47b7-b474-9e31c02e9bba?action=share&source=collection_link&creator=37338910"
	},
	"item": [
		{
			"name": "Patient",
			"item": [
				{
					"name": "Create Patient",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const response = pm.response.json();",
									"pm.test(\"Validating Status Code\", ()=> {",
									"    pm.expect(pm.response.code).to.eql(pm.variables.get(\"statusCode\"));",
									"});",
									"const jsonSchema = {",
									"  \"type\": \"object\",",
									"  \"properties\": {",
									"    \"patientId\": {",
									"      \"type\": \"integer\"",
									"    },",
									"    \"FirstName\": {",
									"      \"type\": \"string\"",
									"    },",
									"    \"LastName\": {",
									"      \"type\": \"string\"",
									"    },",
									"    \"ContactNumber\": {",
									"      \"type\": \"string\"",
									"    },",
									"    \"Email\": {",
									"      \"type\": \"string\",",
									"      \"format\": \"email\"",
									"    },",
									"    \"Allergy\": {",
									"      \"type\": \"string\"",
									"    },",
									"    \"FoodPreference\": {",
									"      \"type\": \"string\"",
									"    },",
									"    \"CuisineCategory\": {",
									"      \"type\": \"string\"",
									"    },",
									"    \"FileMorbidity\": {",
									"      \"type\": \"object\",",
									"      \"properties\": {",
									"        \"66ad4e104717cf471aaad141\": {",
									"          \"type\": \"object\",",
									"          \"properties\": {",
									"            \"T4\": {",
									"              \"type\": \"string\"",
									"            },",
									"            \"TSH\": {",
									"              \"type\": \"string\"",
									"            }",
									"          }",
									"           ",
									"        }",
									"      }",
									"       ",
									"    },",
									"    \"FileMorbidityCondition\": {",
									"      \"type\": \"object\",",
									"      \"properties\": {",
									"        \"66ad4e104717cf471aaad141\": {",
									"          \"type\": \"string\"",
									"        }",
									"      }",
									"    },",
									"    \"DateOfBirth\": {",
									"      \"type\": \"string\",",
									"      \"format\": \"date\"",
									"    },",
									"    \"DieticianId\": {",
									"      \"type\": \"integer\"",
									"    },",
									"    \"Vitals\": {",
									"      \"type\": \"object\",",
									"      \"properties\": {",
									"        \"66ad4e104717cf471aaad141\": {",
									"          \"type\": \"object\",",
									"          \"properties\": {",
									"            \"Weight\": {",
									"              \"type\": \"integer\"",
									"            },",
									"            \"Height\": {",
									"              \"type\": \"integer\"",
									"            },",
									"            \"Temperature\": {",
									"              \"type\": \"integer\"",
									"            },",
									"            \"SP\": {",
									"              \"type\": \"integer\"",
									"            },",
									"            \"DP\": {",
									"              \"type\": \"integer\"",
									"            }",
									"          }",
									"           ",
									"        }",
									"      }",
									"      ",
									"    },",
									"    \"LastVisitDate\": {",
									"      \"type\": \"string\",",
									"      \"format\": \"date-time\"",
									"    }",
									"  }",
									"   ",
									"};",
									"if(pm.response.code === 201)",
									"{",
									"pm.test(\"Verify JSON Schema\",function(){",
									"    pm.response.to.have.jsonSchema(jsonSchema);",
									"   ",
									"});",
									" ",
									"pm.test(\"Content-Type header is application/json\", ()=>{",
									"    pm.response.to.have.header(\"Content-Type\");",
									"    pm.expect(pm.response.headers.get('Content-Type')).to.eql('application/json');",
									"});",
									" pm.environment.set(\"patientId\",response.patientId);",
									"}",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						},
						{
							"listen": "prerequest",
							"script": {
								"exec": [
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{DieticianBearer_Token}}",
									"type": "string"
								}
							]
						},
						"method": "POST",
						"header": [],
						"body": {
							"mode": "formdata",
							"formdata": [
								{
									"key": "file",
									"type": "file",
									"src": "postman-cloud:///1ef50cc9-f80e-45f0-b1d1-866c01f86e3e"
								},
								{
									"key": "patientInfo",
									"value": "{ \n\"FirstName\": \"{{p_FirstName}}\",\n\"LastName\": \"{{p_Lastname}}\",\n\"ContactNumber\": \"{{p_ContactNumber}}\",\n\"Email\": \"{{p_Email}}\",\n\"Allergy\": \"{{p_Allergy}}\",\n\"FoodPreference\": \"{{p_FoodPreferences}}\",\n\"CuisineCategory\":\"{{p_CuisineCatergory}}\",\n\"DateOfBirth\": \"{{p_DateOfBirth}}\"\n}\n\n",
									"contentType": "",
									"type": "text"
								}
							]
						},
						"url": {
							"raw": "{{BaseURL}}{{Endpoint}}",
							"host": [
								"{{BaseURL}}{{Endpoint}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Get Patients Morbidity Details",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"const response = pm.response.json(); ",
									"pm.test(\"Validating Status Code\", ()=> {",
									"    pm.expect(pm.response.code).to.eql(pm.variables.get(\"statusCode\"));",
									"});",
									"",
									"const jsonSchema = {",
									"  \"type\": \"array\",",
									"  \"items\": {",
									"    \"type\": \"object\",",
									"    \"properties\": {",
									"      \"fileId\": {",
									"        \"type\": \"string\"",
									"      },",
									"      \"fileName\": {",
									"        \"type\": \"string\"",
									"      },",
									"      \"uploadDate\": {",
									"        \"type\": \"string\",",
									"        \"format\": \"date-time\"",
									"      },",
									"      \"morbidConditions\": {",
									"        \"type\": \"object\",",
									"        \"properties\": {",
									"          \"T4\": {",
									"            \"type\": \"string\"",
									"          },",
									"          \"TSH\": {",
									"            \"type\": \"string\"",
									"          }",
									"        } ",
									"      },",
									"      \"vitals\": {",
									"        \"type\": \"object\",",
									"        \"properties\": {",
									"          \"Weight\": {",
									"            \"type\": \"integer\"",
									"          },",
									"          \"Height\": {",
									"            \"type\": \"integer\"",
									"          },",
									"          \"Temperature\": {",
									"            \"type\": \"integer\"",
									"          },",
									"          \"SP\": {",
									"            \"type\": \"integer\"",
									"          },",
									"          \"DP\": {",
									"            \"type\": \"integer\"",
									"          }",
									"        } ",
									"      },",
									"      \"morbidConditionStr\": {",
									"        \"type\": \"string\"",
									"      }",
									"    } ",
									"  }",
									"};",
									"if(pm.response.code === 200)",
									"{",
									"     pm.test(\"Verify JSON Schema\", ()=> {",
									"       pm.response.to.have.jsonSchema(jsonSchema)",
									"     });",
									"      pm.environment.set(\"fileId\",response[0].fileId);",
									"    ",
									"}     ",
									"",
									"",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{DieticianBearer_Token}}",
									"type": "string"
								}
							]
						},
						"method": "GET",
						"header": [],
						"url": {
							"raw": "{{BaseURL}}{{Endpoint}}",
							"host": [
								"{{BaseURL}}{{Endpoint}}"
							]
						}
					},
					"response": []
				},
				{
					"name": "Delete by patient id",
					"event": [
						{
							"listen": "test",
							"script": {
								"exec": [
									"pm.test(\"StatusCode Validation\",()=>{",
									"    pm.expect(response).to.eql(pm.variables.get(\"statusCode\"));",
									"});",
									"const statusCode = pm.response.code;",
									"if (statusCode === 200) {",
									"    console.log('Status code is 200. Running assertions...');",
									"var responseBody = pm.response.text();",
									"pm.test(\"Response body contains expected text\", function () {",
									"    pm.expect(responseBody).to.contains(\"deleted Successful\")",
									"});",
									"}",
									" ",
									" ",
									""
								],
								"type": "text/javascript",
								"packages": {}
							}
						}
					],
					"request": {
						"auth": {
							"type": "bearer",
							"bearer": [
								{
									"key": "token",
									"value": "{{DieticianBearer_Token}}",
									"type": "string"
								}
							]
						},
						"method": "DELETE",
						"header": [],
						"url": {
							"raw": "{{BaseURL}}{{Endpoint}}",
							"host": [
								"{{BaseURL}}{{Endpoint}}"
							]
						}
					},
					"response": []
				}
			]
		}
	],
	"event": [
		{
			"listen": "prerequest",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					"if (typeof pm.variables.get('requestdata') !== 'object') {",
					"    pm.variables.set('requestdata', pm.iterationData.toObject());",
					"}",
					"const requestdata = pm.variables.get('requestdata');",
					"",
					"if(typeof requestdata !== 'object' || Object.keys(requestdata).length ===0) {",
					"    console.log(\"No external file found\")",
					"    return;",
					"}",
					"",
					"const currentrequest = requestdata.requests.filter(({name}) => name === pm.info.requestName) [0];",
					"if(!currentrequest){",
					"    console.log(`Request ${pm.info.requestName} has no data defined.`);",
					"}",
					"",
					"const variables = currentrequest.data.shift();",
					"",
					"Object.entries(variables).forEach(([key, value]) => {",
					"        pm.variables.set(key, value);",
					"    });",
					"",
					"pm.variables.set('requestdata',requestdata);",
					"if(currentrequest.data.length > 0){",
					"    pm.execution.setNextRequest(pm.info.requestName)",
					"}"
				]
			}
		},
		{
			"listen": "test",
			"script": {
				"type": "text/javascript",
				"packages": {},
				"exec": [
					""
				]
			}
		}
	]
}